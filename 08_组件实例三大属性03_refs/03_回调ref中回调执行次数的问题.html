<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>01_字符串形式的ref</title>
</head>
<body><!---->
    <!--建立一个容器-->
    <div id="test"></div>

    <!--引入react核心库-->
    <script type="text/javascript" src="../dependent/react.development.js"></script>
    <!--引入react-dom,用于支持react-->
    <script type="text/javascript" src="../dependent/react-dom.development.js"></script>
    <!--引入babel,用于将jsx转化为js-->
    <script type="text/javascript" src="../dependent/babel.min.js"></script>


    <script type="text/babel">  // 此处一定要挟babel。
    // 创建class组件
    class Demo extends React.Component{

        state= {isHot:false}

        showInfo=()=>{
            //直接从实例上取this即可，不需要写this.input
            const {input1}=this
            alert(input1.value)
        }

        changeWeather=()=>{
            const {isHot}=this.state
            //更新状态
            this.setState({isHot:!isHot})
        }

        saveInput=(c)=>{
            this.input1 = c;
            console.log('@',c)
        }

        render(){
            const {isHot} = this.state
            return (
                /**
                 * 如果ref回调函数是以內联函数的方式定义的，在更新过程中，它会被执行2次，第一次是传入参数null，然后第二次会传入参数DOM元素。
                 * 这是因为在每次渲染时会创建一个新的函数实例，所以React清空旧的ref并且设置新的。
                 * 但是通过将ref的回调函数定义成class的绑定函数的方式可以避免上述问题。但是大多数情况下时无关紧要的。
                 * */ 
                <div>
                    <h2>今天天气很{isHot? '炎热' : '凉爽'}</h2>
                    {/*<input ref={(c)=>{this.input1 = c; console.log('@', c)}} type="text"/> <br/><br/>*/}
                    {/*以上方式是写好回调函数，让react去调用. 以下方法是使用class的绑定函数方式（this.saveInput），将回调函数放在了组件实例的自身上*/}
                    <input ref={this.saveInput} type="text"/>
                    <button onClick={this.showInfo}>点击提示输入的数据</button>
                    <button onClick={this.changeWeather}>点我切换天气</button>
                </div>
            )
        }
    }
    //渲染class组件
    ReactDOM.render(<Demo/>,document.getElementById('test'))
    </script>
</body>
</html>